/*add adverse_event indicator*/
data mscan.analytical_cohort; /* Replace 'your_dataset' with the actual name of your dataset */
    set mscan.analytical_cohort;
    if admdate ne . then adverse_event = 1;
    else adverse_event = 0;
run;

/*add interacting indicator*/
proc sort data=mscan.overlap_period_final_comb;
    by enrolid overlap_start;
run;


data enrolid_interacting;
    set mscan.overlap_period_final_comb;
    by enrolid;
    if first.enrolid;
    keep enrolid interacting;
run;

proc sql;
    create table mscan.analytical_cohort as
    select a.*, b.interacting
    from mscan.analytical_cohort as a
    left join enrolid_interacting as b
    on a.enrolid = b.enrolid;
quit;

