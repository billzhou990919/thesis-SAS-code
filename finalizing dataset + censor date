/*current dataset is called mscan.final_continuous_enrollment*/
proc sql;
    create table mscan.overlap_period_final as
    select * from mscan.overlap_period_3
    where enrolid in (select enrolid from mscan.final_continuous_enrollment);
quit;

data enrolid_sex;
    set mscan.all_enrollment;
    by enrolid;
    if first.enrolid;
    keep enrolid sex;
run;

proc sql;
    create table mscan.analytical_cohort as
    select a.*, b.sex
    from mscan.final_continuous_enrollment as a
    left join enrolid_sex as b
    on a.enrolid = b.enrolid;
    keep enrolid day0 sex;
quit;

