///// getting all drug files /////
proc sql;
    create table mscan.comedication2015 as
    select enrolid, svcdate, dx1, dx2, dx3, dx4 from source.ccaeo151
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.outpatient2016 as
    select enrolid, svcdate, dx1, dx2, dx3, dx4 from source.ccaeo161
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.outpatient2017 as
    select enrolid, svcdate, dx1, dx2, dx3, dx4 from source.ccaeo171
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.outpatient2018 as
    select enrolid, svcdate, dx1, dx2, dx3, dx4 from source.ccaeo181
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.outpatient2019 as
    select enrolid, svcdate, dx1, dx2, dx3, dx4 from source.ccaeo192
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;
/////////////////////
proc sql;
    create table mscan.outpatient2016 as
    select a.enrolid, a.svcdate, a.dx1, a.dx2, a.dx3, a.dx4
    from source.ccaeo161 a
    join mscan.analytical_cohort b
    on a.enrolid = b.enrolid;
Quit;

proc sql;
    create table mscan.outpatient2017 as
    select a.enrolid, a.svcdate, a.dx1, a.dx2, a.dx3, a.dx4
    from source.ccaeo171 a
    join mscan.analytical_cohort b
    on a.enrolid = b.enrolid;
Quit;

proc sql;
    create table mscan.outpatient2018 as
    select a.enrolid, a.svcdate, a.dx1, a.dx2, a.dx3, a.dx4
    from source.ccaeo181 a
    join mscan.analytical_cohort b
    on a.enrolid = b.enrolid;
Quit;

proc sql;
    create table mscan.outpatient2019 as
    select a.enrolid, a.svcdate, a.dx1, a.dx2, a.dx3, a.dx4
    from source.ccaeo192 a
    join mscan.analytical_cohort b
    on a.enrolid = b.enrolid;
quit;


Data mscan.outpatient;
Set mscan.outpatient2010 mscan.outpatient2011 mscan.outpatient2012 mscan.outpatient2013 mscan.outpatient2014 mscan.outpatient2015 mscan.outpatient2016 mscan.outpatient2017 
Mscan.outpatient2018  mscan.outpatient2019;
