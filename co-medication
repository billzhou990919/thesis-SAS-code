///// getting all drug files /////
proc sql;
    create table mscan.comedication2010 as
    select enrolid, svcdate, ndcnum from source.ccaed103
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.comedication2011 as
    select enrolid, svcdate, ndcnum from source.ccaed112
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.comedication2012 as
    select enrolid, svcdate, ndcnum from source.ccaed121
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.comedication2013 as
    select enrolid, svcdate, ndcnum from source.ccaed131
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.comedication2014 as
    select enrolid, svcdate, ndcnum from source.ccaed141
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;


proc sql;
    create table mscan.comedication2015 as
    select enrolid, svcdate, ndcnum from source.ccaed151
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.comedication2016 as
    select enrolid, svcdate, ndcnum from source.ccaed161
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.comedication2017 as
    select enrolid, svcdate, ndcnum from source.ccaed171
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.comedication2018 as
    select enrolid, svcdate, ndcnum from source.ccaed181
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;

proc sql;
    create table mscan.comedication2019 as
    select enrolid, svcdate, ndcnum from source.ccaed192
    where enrolid in (select enrolid from mscan.analytical_cohort);
quit;
/////////////////////


Data mscan.comedication;
Set mscan.comedication2010 mscan.comedication2011 mscan.comedication2012 mscan.comedication2013 mscan.comedication2014 mscan.comedication2015 mscan.comedication2016 mscan.comedication2017 
Mscan.comedication2018  mscan.comedication2019;
run;

////getting all co-medications 3 months prior to day0 or within the concomitant period/////
proc sql;
    create table mscan.comedication_final as
    select a.enrolid, a.day0, a.censor_date, b.svcdate, b.ndcnum
    from mscan.analytical_cohort as a
    left join mscan.comedication as b
    on a.enrolid = b.enrolid
    where (a.day0-90) <= b.svcdate < a.censor_date;
    /*where (0 <= (a.day0 - b.svcdate) <= 90) or (a.day0 <= b.svcdate < a.censor_date);*/

quit;





/*ndc num for all co-medications*/
data mscan.ndc_acei;
set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;
if lowcase(THRCLDS) in:('benazepril', 'captopril', 'cilazapril', 'enalapril', 'enalaprilat', 'fosinopril', 'lisinopril', 'moexipril', 'perindopril', 'quinapril', 'ramipril', 'trandolapril', 'spirapril', 'temocapril', 'zofenopril', 'imidapril', 'delapril') or 
lowcase(THRGRDS) in:('benazepril', 'captopril', 'cilazapril', 'enalapril', 'enalaprilat', 'fosinopril', 'lisinopril', 'moexipril', 'perindopril', 'quinapril', 'ramipril', 'trandolapril', 'spirapril', 'temocapril', 'zofenopril', 'imidapril', 'delapril') or
lowcase(PRODNME) in:('benazepril', 'captopril', 'cilazapril', 'enalapril', 'enalaprilat', 'fosinopril', 'lisinopril', 'moexipril', 'perindopril', 'quinapril', 'ramipril', 'trandolapril', 'spirapril', 'temocapril', 'zofenopril', 'imidapril', 'delapril') or
lowcase(GENNME) in:('benazepril', 'captopril', 'cilazapril', 'enalapril', 'enalaprilat', 'fosinopril', 'lisinopril', 'moexipril', 'perindopril', 'quinapril', 'ramipril', 'trandolapril', 'spirapril', 'temocapril', 'zofenopril', 'imidapril', 'delapril');
run;

data mscan.ndc_arb;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;
    if lowcase(THRCLDS) in:('valsartan', 'olmesartan', 'eprosartan', 'telmisartan', 'irbesartan', 'tasosartan', 'azilsartan', 'fimasartan', 'candesartan', 'losartan') or 
       lowcase(THRGRDS) in:('valsartan', 'olmesartan', 'eprosartan', 'telmisartan', 'irbesartan', 'tasosartan', 'azilsartan', 'fimasartan', 'candesartan', 'losartan') or
       lowcase(PRODNME) in:('valsartan', 'olmesartan', 'eprosartan', 'telmisartan', 'irbesartan', 'tasosartan', 'azilsartan', 'fimasartan', 'candesartan', 'losartan') or
       lowcase(GENNME) in:('valsartan', 'olmesartan', 'eprosartan', 'telmisartan', 'irbesartan', 'tasosartan', 'azilsartan', 'fimasartan', 'candesartan', 'losartan');
run;



data mscan.ndc_av;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('nitroglycerin', 'glyceryl trinitrate', 'isosorbide dinitrate', 'isosorbide mononitrate', 'erythrityl tetranitrate', 'pentaerythritol tetranitrate', 'nicorandil', 'molsidomine', 'trapidil', 'imolamine', 'hexobendine') or 
       lowcase(THRGRDS) in:('nitroglycerin', 'glyceryl trinitrate', 'isosorbide dinitrate', 'isosorbide mononitrate', 'erythrityl tetranitrate', 'pentaerythritol tetranitrate', 'nicorandil', 'molsidomine', 'trapidil', 'imolamine', 'hexobendine') or
       lowcase(PRODNME) in:('nitroglycerin', 'glyceryl trinitrate', 'isosorbide dinitrate', 'isosorbide mononitrate', 'erythrityl tetranitrate', 'pentaerythritol tetranitrate', 'nicorandil', 'molsidomine', 'trapidil', 'imolamine', 'hexobendine') or
       lowcase(GENNME) in:('nitroglycerin', 'glyceryl trinitrate', 'isosorbide dinitrate', 'isosorbide mononitrate', 'erythrityl tetranitrate', 'pentaerythritol tetranitrate', 'nicorandil', 'molsidomine', 'trapidil', 'imolamine', 'hexobendine');

run;

data mscan.ndc_antiarrhythmics;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('quinidine', 'procainamide', 'disopyramide', 'sparteine', 'ajmaline', 'prajmaline', 'lorajmine', 'hydroquinidine', 'lidocaine', 'mexiletine', 'tocainide', 'aprindine', 'propafenone', 'flecainide', 'lorcainide', 'encainide', 'ethacizine', 'amiodarone', 
'bretylium', 'bunaftine', 'dofetilide', 'ibutilide', 'tedisamil', 'dronedarone', 'moracizine', 'cibenzoline', 'vernakalant')
       or
       lowcase(THRGRDS) in:('quinidine', 'procainamide', 'disopyramide', 'sparteine', 'ajmaline', 'prajmaline', 'lorajmine', 'hydroquinidine', 'lidocaine', 'mexiletine', 'tocainide', 'aprindine', 'propafenone', 'flecainide', 'lorcainide', 'encainide', 'ethacizine', 'amiodarone', 
'bretylium', 'bunaftine', 'dofetilide', 'ibutilide', 'tedisamil', 'dronedarone', 'moracizine', 'cibenzoline', 'vernakalant')
       or
       lowcase(PRODNME) in:('quinidine', 'procainamide', 'disopyramide', 'sparteine', 'ajmaline', 'prajmaline', 'lorajmine', 'hydroquinidine', 'lidocaine', 'mexiletine', 'tocainide', 'aprindine', 'propafenone', 'flecainide', 'lorcainide', 'encainide', 'ethacizine', 'amiodarone', 
'bretylium', 'bunaftine', 'dofetilide', 'ibutilide', 'tedisamil', 'dronedarone', 'moracizine', 'cibenzoline', 'vernakalant')
       or
       lowcase(GENNME) in:('quinidine', 'procainamide', 'disopyramide', 'sparteine', 'ajmaline', 'prajmaline', 'lorajmine', 'hydroquinidine', 'lidocaine', 'mexiletine', 'tocainide', 'aprindine', 'propafenone', 'flecainide', 'lorcainide', 'encainide', 'ethacizine', 'amiodarone', 
'bretylium', 'bunaftine', 'dofetilide', 'ibutilide', 'tedisamil', 'dronedarone', 'moracizine', 'cibenzoline', 'vernakalant');

run;

data mscan.ndc_antiplatelets;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('ditazole', 'cloricromen', 'picotamide', 'clopidogrel', 'ticlopidine', 'dipyridamole', 'carbasalate calcium', 'epoprostenol', 'indobufen', 'iloprost', 'abciximab', 'aloxiprin', 'eptifibatide', 'tirofiban', 'triflusal', 'beraprost', 'treprostinil', 
'prasugrel', 'cilostazol', 'ticagrelor', 'cangrelor', 'vorapaxar', 'selexipag')
       or
       lowcase(THRGRDS) in:('ditazole', 'cloricromen', 'picotamide', 'clopidogrel', 'ticlopidine', 'dipyridamole', 'carbasalate calcium', 'epoprostenol', 'indobufen', 'iloprost', 'abciximab', 'aloxiprin', 'eptifibatide', 'tirofiban', 'triflusal', 'beraprost', 'treprostinil', 'prasugrel', 
'cilostazol', 'ticagrelor', 'cangrelor', 'vorapaxar', 'selexipag')
       or
       lowcase(PRODNME) in:('ditazole', 'cloricromen', 'picotamide', 'clopidogrel', 'ticlopidine', 'dipyridamole', 'carbasalate calcium', 'epoprostenol', 'indobufen', 'iloprost', 'abciximab', 'aloxiprin', 'eptifibatide', 'tirofiban', 'triflusal', 'beraprost', 'treprostinil', 'prasugrel',
'cilostazol', 'ticagrelor', 'cangrelor', 'vorapaxar', 'selexipag')
       or
       lowcase(GENNME) in:('ditazole', 'cloricromen', 'picotamide', 'clopidogrel', 'ticlopidine', 'dipyridamole', 'carbasalate calcium', 'epoprostenol', 'indobufen', 'iloprost', 'abciximab', 'aloxiprin', 'eptifibatide', 'tirofiban', 'triflusal', 'beraprost', 'treprostinil', 'prasugrel', 'cilostazol', 
'ticagrelor', 'cangrelor', 'vorapaxar', 'selexipag');

run;

data mscan.ndc_aspirin;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('aspirin', 'acetylsalicylic acid')
       or
       lowcase(THRGRDS) in:('aspirin', 'acetylsalicylic acid')
       or
       lowcase(PRODNME) in:('aspirin', 'acetylsalicylic acid')
       or
       lowcase(GENNME) in:('aspirin', 'acetylsalicylic acid');

run;

data mscan.ndc_beta_blockers;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('alprenolol', 'oxprenolol', 'pindolol', 'propranolol', 'timolol', 'sotalol', 'nadolol', 'mepindolol', 'carteolol', 'tertatolol', 'bopindolol', 'bupranolol', 'penbutolol', 'cloranolol', 'practolol', 'metoprolol', 'atenolol', 'acebutolol', 'betaxolol', 'bevantolol', 'bisoprolol', 
'celiprolol', 'esmolol', 'epanolol', 's-atenolol', 'nebivolol', 'talinolol', 'landiolol', 'labetalol', 'carvedilol')
       or
       lowcase(THRGRDS) in:('alprenolol', 'oxprenolol', 'pindolol', 'propranolol', 'timolol', 'sotalol', 'nadolol', 'mepindolol', 'carteolol', 'tertatolol', 'bopindolol', 'bupranolol', 'penbutolol', 'cloranolol', 'practolol', 'metoprolol', 'atenolol', 'acebutolol', 'betaxolol', 'bevantolol', 'bisoprolol', 
'celiprolol', 'esmolol', 'epanolol', 's-atenolol', 'nebivolol', 'talinolol', 'landiolol', 'labetalol', 'carvedilol')
       or
       lowcase(PRODNME) in:('alprenolol', 'oxprenolol', 'pindolol', 'propranolol', 'timolol', 'sotalol', 'nadolol', 'mepindolol', 'carteolol', 'tertatolol', 'bopindolol', 'bupranolol', 'penbutolol', 'cloranolol', 'practolol', 'metoprolol', 'atenolol', 'acebutolol', 'betaxolol', 'bevantolol', 'bisoprolol', 
'celiprolol', 'esmolol', 'epanolol', 's-atenolol', 'nebivolol', 'talinolol', 'landiolol', 'labetalol', 'carvedilol')
       or
       lowcase(GENNME) in:('alprenolol', 'oxprenolol', 'pindolol', 'propranolol', 'timolol', 'sotalol', 'nadolol', 'mepindolol', 'carteolol', 'tertatolol', 'bopindolol', 'bupranolol', 'penbutolol', 'cloranolol', 'practolol', 'metoprolol', 'atenolol', 'acebutolol', 'betaxolol', 'bevantolol', 'bisoprolol', 
'celiprolol', 'esmolol', 'epanolol', 's-atenolol', 'nebivolol', 'talinolol', 'landiolol', 'labetalol', 'carvedilol');

run;

data mscan.ndc_calcium_channel_blockers;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('amlodipine', 'felodipine', 'isradipine', 'nicardipine', 'nifedipine', 'nimodipine', 'nisoldipine', 'nitrendipine', 'lacidipine', 'nilvadipine', 'manidipine', 'barnidipine', 'lercanidipine', 'cilnidipine', 'benidipine', 'clevidipine', 'mibefradil', 'fendiline', 'bepridil', 'lidoflazine', 'perhexiline')
       or
       lowcase(THRGRDS) in:('amlodipine', 'felodipine', 'isradipine', 'nicardipine', 'nifedipine', 'nimodipine', 'nisoldipine', 'nitrendipine', 'lacidipine', 'nilvadipine', 'manidipine', 'barnidipine', 'lercanidipine', 'cilnidipine', 'benidipine', 'clevidipine', 'mibefradil', 'fendiline', 'bepridil', 'lidoflazine', 'perhexiline')
       or
       lowcase(PRODNME) in:('amlodipine', 'felodipine', 'isradipine', 'nicardipine', 'nifedipine', 'nimodipine', 'nisoldipine', 'nitrendipine', 'lacidipine', 'nilvadipine', 'manidipine', 'barnidipine', 'lercanidipine', 'cilnidipine', 'benidipine', 'clevidipine', 'mibefradil', 'fendiline', 'bepridil', 'lidoflazine', 'perhexiline')
       or
       lowcase(GENNME) in:('amlodipine', 'felodipine', 'isradipine', 'nicardipine', 'nifedipine', 'nimodipine', 'nisoldipine', 'nitrendipine', 'lacidipine', 'nilvadipine', 'manidipine', 'barnidipine', 'lercanidipine', 'cilnidipine', 'benidipine', 'clevidipine', 'mibefradil', 'fendiline', 'bepridil', 'lidoflazine', 'perhexiline');

run;

data mscan.ndc_diuretics;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('bendroflumethiazide', 'hydroflumethiazide', 'hydrochlorothiazide', 'chlorothiazide', 'polythiazide', 'trichlormethiazide', 'cyclopenthiazide', 'methyclothiazide', 'cyclothiazide', 'mebutizide', 'quinethazone', 'clopamide', 'chlortalidone', 'mefruside', 'clofenamide', 'metolazone', 'meticrane', 'xipamide', 'indapamide', 
'clorexolone', 'fenquizone', 'mersalyl', 'theobromine', 'cicletanine', 'furosemide', 'bumetanide', 'piretanide', 'torasemide', 'etacrynic acid', 'tienilic acid', 'muzolimine', 'etozolin', 'spironolactone', 'potassium canrenoate', 'canrenone', 'eplerenone', 'amiloride', 'triamterene', 'tolvaptan', 'conivaptan')
       or
       lowcase(THRGRDS) in:('bendroflumethiazide', 'hydroflumethiazide', 'hydrochlorothiazide', 'chlorothiazide', 'polythiazide', 'trichlormethiazide', 'cyclopenthiazide', 'methyclothiazide', 'cyclothiazide', 'mebutizide', 'quinethazone', 'clopamide', 'chlortalidone', 'mefruside', 'clofenamide', 'metolazone', 'meticrane', 'xipamide', 'indapamide', 
'clorexolone', 'fenquizone', 'mersalyl', 'theobromine', 'cicletanine', 'furosemide', 'bumetanide', 'piretanide', 'torasemide', 'etacrynic acid', 'tienilic acid', 'muzolimine', 'etozolin', 'spironolactone', 'potassium canrenoate', 'canrenone', 'eplerenone', 'amiloride', 'triamterene', 'tolvaptan', 'conivaptan')
       or
       lowcase(PRODNME) in:('bendroflumethiazide', 'hydroflumethiazide', 'hydrochlorothiazide', 'chlorothiazide', 'polythiazide', 'trichlormethiazide', 'cyclopenthiazide', 'methyclothiazide', 'cyclothiazide', 'mebutizide', 'quinethazone', 'clopamide', 'chlortalidone', 'mefruside', 'clofenamide', 'metolazone', 'meticrane', 'xipamide', 'indapamide', 
'clorexolone', 'fenquizone', 'mersalyl', 'theobromine', 'cicletanine', 'furosemide', 'bumetanide', 'piretanide', 'torasemide', 'etacrynic acid', 'tienilic acid', 'muzolimine', 'etozolin', 'spironolactone', 'potassium canrenoate', 'canrenone', 'eplerenone', 'amiloride', 'triamterene', 'tolvaptan', 'conivaptan')
       or
       lowcase(GENNME) in:('bendroflumethiazide', 'hydroflumethiazide', 'hydrochlorothiazide', 'chlorothiazide', 'polythiazide', 'trichlormethiazide', 'cyclopenthiazide', 'methyclothiazide', 'cyclothiazide', 'mebutizide', 'quinethazone', 'clopamide', 'chlortalidone', 'mefruside', 'clofenamide', 'metolazone', 'meticrane', 'xipamide', 'indapamide', 
'clorexolone', 'fenquizone', 'mersalyl', 'theobromine', 'cicletanine', 'furosemide', 'bumetanide', 'piretanide', 'torasemide', 'etacrynic acid', 'tienilic acid', 'muzolimine', 'etozolin', 'spironolactone', 'potassium canrenoate', 'canrenone', 'eplerenone', 'amiloride', 'triamterene', 'tolvaptan', 'conivaptan');

run;

data mscan.ndc_other_antihypertensives;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('rescinnamine', 'reserpine', 'deserpidine', 'rauwolfia alkaloids', 'rauwolfia alkaloids, whole root', 'combinations of rauwolfia alkaloids', 'methoserpidine', 'bietaserpine', 'methyldopa', 'clonidine', 'guanfacine', 'tolonidine', 'moxonidine', 'rilmenidine', 'trimetaphan', 'mecamylamine', 'prazosin', 'indoramin', 
'trimazosin', 'doxazosin', 'urapidil', 'betanidine', 'guanethidine', 'guanoxan', 'debrisoquine', 'guanoclor', 'guanazodine', 'guanoxabenz', 'diazoxide', 'dihydralazine', 'hydralazine', 'endralazine', 'cadralazine', 'minoxidil', 'nitroprusside', 'pinacidil', 'veratrum', 'metirosine', 'pargyline', 'ketanserin', 'bosentan', 'ambrisentan', 'sitaxentan', 
'macitentan', 'riociguat', 'ambrisentan and tadalafil')
       or
       lowcase(THRGRDS) in:('rescinnamine', 'reserpine', 'deserpidine', 'rauwolfia alkaloids', 'rauwolfia alkaloids, whole root', 'combinations of rauwolfia alkaloids', 'methoserpidine', 'bietaserpine', 'methyldopa', 'clonidine', 'guanfacine', 'tolonidine', 'moxonidine', 'rilmenidine', 'trimetaphan', 'mecamylamine', 'prazosin', 'indoramin', 'trimazosin', 
'doxazosin', 'urapidil', 'betanidine', 'guanethidine', 
'guanoxan', 'debrisoquine', 'guanoclor', 'guanazodine', 'guanoxabenz', 'diazoxide', 'dihydralazine', 'hydralazine', 'endralazine', 'cadralazine', 'minoxidil', 'nitroprusside', 'pinacidil', 'veratrum', 'metirosine', 'pargyline', 'ketanserin', 'bosentan', 'ambrisentan', 'sitaxentan', 'macitentan', 'riociguat', 'ambrisentan and tadalafil')
       or
       lowcase(PRODNME) in:('rescinnamine', 'reserpine', 'deserpidine', 'rauwolfia alkaloids', 'rauwolfia alkaloids, whole root', 'combinations of rauwolfia alkaloids', 'methoserpidine', 'bietaserpine', 'methyldopa', 'clonidine', 'guanfacine', 'tolonidine', 'moxonidine', 'rilmenidine', 'trimetaphan', 'mecamylamine', 'prazosin', 'indoramin', 'trimazosin', 
'doxazosin', 'urapidil', 'betanidine', 'guanethidine', 
'guanoxan', 'debrisoquine', 'guanoclor', 'guanazodine', 'guanoxabenz', 'diazoxide', 'dihydralazine', 'hydralazine', 'endralazine', 'cadralazine', 'minoxidil', 'nitroprusside', 'pinacidil', 'veratrum', 'metirosine', 'pargyline', 'ketanserin', 'bosentan', 'ambrisentan', 'sitaxentan', 'macitentan', 'riociguat', 'ambrisentan and tadalafil')
       or
       lowcase(GENNME) in:('rescinnamine', 'reserpine', 'deserpidine', 'rauwolfia alkaloids', 'rauwolfia alkaloids, whole root', 'combinations of rauwolfia alkaloids', 'methoserpidine', 'bietaserpine', 'methyldopa', 'clonidine', 'guanfacine', 'tolonidine', 'moxonidine', 'rilmenidine', 'trimetaphan', 'mecamylamine', 'prazosin', 'indoramin', 'trimazosin', 
'doxazosin', 'urapidil', 'betanidine', 'guanethidine', 
'guanoxan', 'debrisoquine', 'guanoclor', 'guanazodine', 'guanoxabenz', 'diazoxide', 'dihydralazine', 'hydralazine', 'endralazine', 'cadralazine', 'minoxidil', 'nitroprusside', 'pinacidil', 'veratrum', 'metirosine', 'pargyline', 'ketanserin', 'bosentan', 'ambrisentan', 'sitaxentan', 'macitentan', 'riociguat', 'ambrisentan and tadalafil');

run;

data mscan.ndc_diabetes_drugs;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('insulin', 'insulin lispro', 'insulin aspart', 'insulin glulisine', 'insulin degludec and insulin aspart', 'insulin glargine', 'insulin detemir', 'insulin degludec', 'insulin degludec and liraglutide', 'insulin glargine and lixisenatide', 'phenformin', 'metformin', 'buformin', 'glibenclamide', 'chlorpropamide', 'tolbutamide',
'glibornuride', 'tolazamide', 'carbutamide', 'glipizide', 'gliquidone', 'gliclazide', 'metahexamide', 'glisoxepide', 'glimepiride', 'acetohexamide', 'glymidine', 'acarbose', 'miglitol', 'voglibose', 'troglitazone', 'rosiglitazone', 'pioglitazone', 'sitagliptin', 'vildagliptin', 'saxagliptin', 'alogliptin', 'linagliptin', 'gemigliptin', 'evogliptin', 
'exenatide', 'liraglutide', 'lixisenatide', 'albiglutide', 'dulaglutide', 'semaglutide', 'dapagliflozin', 'canagliflozin', 'empagliflozin', 'ertugliflozin', 'ipragliflozin', 'sotagliflozin', 'repaglinide', 'nateglinide', 'pramlintide', 'benfluorex', 'mitiglinide')
       or
       lowcase(THRGRDS) in:('insulin', 'insulin lispro', 'insulin aspart', 'insulin glulisine', 'insulin degludec and insulin aspart', 'insulin glargine', 'insulin detemir', 'insulin degludec', 'insulin degludec and liraglutide', 'insulin glargine and lixisenatide', 'phenformin', 'metformin', 'buformin', 'glibenclamide', 'chlorpropamide', 'tolbutamide',
'glibornuride', 'tolazamide', 'carbutamide', 'glipizide', 'gliquidone', 'gliclazide', 'metahexamide', 'glisoxepide', 'glimepiride', 'acetohexamide', 'glymidine', 'acarbose', 'miglitol', 'voglibose', 'troglitazone', 'rosiglitazone', 'pioglitazone', 'sitagliptin', 'vildagliptin', 'saxagliptin', 'alogliptin', 'linagliptin', 'gemigliptin', 'evogliptin', 
'exenatide', 'liraglutide', 'lixisenatide', 'albiglutide', 'dulaglutide', 'semaglutide', 'dapagliflozin', 'canagliflozin', 'empagliflozin', 'ertugliflozin', 'ipragliflozin', 'sotagliflozin', 'repaglinide', 'nateglinide', 'pramlintide', 'benfluorex', 'mitiglinide')
       or
       lowcase(PRODNME) in:('insulin', 'insulin lispro', 'insulin aspart', 'insulin glulisine', 'insulin degludec and insulin aspart', 'insulin glargine', 'insulin detemir', 'insulin degludec', 'insulin degludec and liraglutide', 'insulin glargine and lixisenatide', 'phenformin', 'metformin', 'buformin', 'glibenclamide', 'chlorpropamide', 'tolbutamide',
'glibornuride', 'tolazamide', 'carbutamide', 'glipizide', 'gliquidone', 'gliclazide', 'metahexamide', 'glisoxepide', 'glimepiride', 'acetohexamide', 'glymidine', 'acarbose', 'miglitol', 'voglibose', 'troglitazone', 'rosiglitazone', 'pioglitazone', 'sitagliptin', 'vildagliptin', 'saxagliptin', 'alogliptin', 'linagliptin', 'gemigliptin', 'evogliptin', 
'exenatide', 'liraglutide', 'lixisenatide', 'albiglutide', 'dulaglutide', 'semaglutide', 'dapagliflozin', 'canagliflozin', 'empagliflozin', 'ertugliflozin', 'ipragliflozin', 'sotagliflozin', 'repaglinide', 'nateglinide', 'pramlintide', 'benfluorex', 'mitiglinide')
       or
       lowcase(GENNME) in:('insulin', 'insulin lispro', 'insulin aspart', 'insulin glulisine', 'insulin degludec and insulin aspart', 'insulin glargine', 'insulin detemir', 'insulin degludec', 'insulin degludec and liraglutide', 'insulin glargine and lixisenatide', 'phenformin', 'metformin', 'buformin', 'glibenclamide', 'chlorpropamide', 'tolbutamide',
'glibornuride', 'tolazamide', 'carbutamide', 'glipizide', 'gliquidone', 'gliclazide', 'metahexamide', 'glisoxepide', 'glimepiride', 'acetohexamide', 'glymidine', 'acarbose', 'miglitol', 'voglibose', 'troglitazone', 'rosiglitazone', 'pioglitazone', 'sitagliptin', 'vildagliptin', 'saxagliptin', 'alogliptin', 'linagliptin', 'gemigliptin', 'evogliptin', 
'exenatide', 'liraglutide', 'lixisenatide', 'albiglutide', 'dulaglutide', 'semaglutide', 'dapagliflozin', 'canagliflozin', 'empagliflozin', 'ertugliflozin', 'ipragliflozin', 'sotagliflozin', 'repaglinide', 'nateglinide', 'pramlintide', 'benfluorex', 'mitiglinide');

run;

data mscan.ndc_estrogens;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('ethinylestradiol', 'estradiol', 'estriol', 'chlorotrianisene', 'estrone', 'promestriene', 'conjugated estrogens', 'dienestrol', 'diethylstilbestrol', 'methallenestril', 'moxestrol', 'tibolone')
       or
       lowcase(THRGRDS) in:('ethinylestradiol', 'estradiol', 'estriol', 'chlorotrianisene', 'estrone', 'promestriene', 'conjugated estrogens', 'dienestrol', 'diethylstilbestrol', 'methallenestril', 'moxestrol', 'tibolone')
       or
       lowcase(PRODNME) in:('ethinylestradiol', 'estradiol', 'estriol', 'chlorotrianisene', 'estrone', 'promestriene', 'conjugated estrogens', 'dienestrol', 'diethylstilbestrol', 'methallenestril', 'moxestrol', 'tibolone')
       or
       lowcase(GENNME) in:('ethinylestradiol', 'estradiol', 'estriol', 'chlorotrianisene', 'estrone', 'promestriene', 'conjugated estrogens', 'dienestrol', 'diethylstilbestrol', 'methallenestril', 'moxestrol', 'tibolone');

run;

data mscan.ndc_progestins;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('gestonorone', 'medroxyprogesterone', 'hydroxyprogesterone', 'progesterone', 'dydrogesterone', 'megestrol', 'medrogestone', 'nomegestrol', 'demegestone', 'chlormadinone', 'promegestone', 'dienogest', 'allylestrenol', 'norethisterone', 'lynestrenol', 'ethisterone', 'etynodiol', 'methylestrenolone')
       or
       lowcase(THRGRDS) in:('gestonorone', 'medroxyprogesterone', 'hydroxyprogesterone', 'progesterone', 'dydrogesterone', 'megestrol', 'medrogestone', 'nomegestrol', 'demegestone', 'chlormadinone', 'promegestone', 'dienogest', 'allylestrenol', 'norethisterone', 'lynestrenol', 'ethisterone', 'etynodiol', 'methylestrenolone')
       or
       lowcase(PRODNME) in:('gestonorone', 'medroxyprogesterone', 'hydroxyprogesterone', 'progesterone', 'dydrogesterone', 'megestrol', 'medrogestone', 'nomegestrol', 'demegestone', 'chlormadinone', 'promegestone', 'dienogest', 'allylestrenol', 'norethisterone', 'lynestrenol', 'ethisterone', 'etynodiol', 'methylestrenolone')
       or
       lowcase(GENNME) in:('gestonorone', 'medroxyprogesterone', 'hydroxyprogesterone', 'progesterone', 'dydrogesterone', 'megestrol', 'medrogestone', 'nomegestrol', 'demegestone', 'chlormadinone', 'promegestone', 'dienogest', 'allylestrenol', 'norethisterone', 'lynestrenol', 'ethisterone', 'etynodiol', 'methylestrenolone');

run;

data mscan.ndc_heparin_lmwh;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('heparin', 'antithrombin III', 'dalteparin', 'enoxaparin', 'nadroparin', 'parnaparin', 'reviparin', 'danaparoid', 'tinzaparin', 'sulodexide', 'bemiparin')
       or
       lowcase(THRGRDS) in:('heparin', 'antithrombin III', 'dalteparin', 'enoxaparin', 'nadroparin', 'parnaparin', 'reviparin', 'danaparoid', 'tinzaparin', 'sulodexide', 'bemiparin')
       or
       lowcase(PRODNME) in:('heparin', 'antithrombin III', 'dalteparin', 'enoxaparin', 'nadroparin', 'parnaparin', 'reviparin', 'danaparoid', 'tinzaparin', 'sulodexide', 'bemiparin')
       or
       lowcase(GENNME) in:('heparin', 'antithrombin III', 'dalteparin', 'enoxaparin', 'nadroparin', 'parnaparin', 'reviparin', 'danaparoid', 'tinzaparin', 'sulodexide', 'bemiparin');

run;

data mscan.ndc_nsaids;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('phenylbutazone', 'mofebutazone', 'oxyphenbutazone', 'clofezone', 'kebuzone', 'indometacin', 'sulindac', 'tolmetin', 'zomepirac', 'diclofenac', 'alclofenac', 'bumadizone', 'etodolac', 'lonazolac', 'fentiazac', 'acemetacin', 'difenpiramide', 'oxametacin', 'proglumetacin', 
'ketorolac', 'aceclofenac', 'bufexamac', 'piroxicam', 'tenoxicam', 'droxicam', 'lornoxicam', 'meloxicam', 'ibuprofen', 'naproxen', 'ketoprofen', 'fenoprofen', 'fenbufen', 'benoxaprofen', 'suprofen', 'pirprofen', 'flurbiprofen', 'indoprofen', 'tiaprofenic acid', 'oxaprozin', 'ibuproxam', 'dexibuprofen', 'flunoxaprofen', 'alminoprofen', 
'dexketoprofen', 'naproxcinod', 'mefenamic acid', 'tolfenamic acid', 'flufenamic acid', 'meclofenamic acid', 'celecoxib', 'rofecoxib', 'valdecoxib', 'parecoxib', 'etoricoxib', 'lumiracoxib', 'polmacoxib', 'nabumetone', 'niflumic acid', 'azapropazone', 'glucosamine', 'benzydamine', 'glucosaminoglycan polysulfate', 'proquazone', 'orgotein', 
'nimesulide', 'feprazone', 'diacerein', 'morniflumate', 'tenidap', 'oxaceprol', 'chondroitin sulfate')
       or
       lowcase(THRGRDS) in:('phenylbutazone', 'mofebutazone', 'oxyphenbutazone', 'clofezone', 'kebuzone', 'indometacin', 'sulindac', 'tolmetin', 'zomepirac', 'diclofenac', 'alclofenac', 'bumadizone', 'etodolac', 'lonazolac', 'fentiazac', 'acemetacin', 'difenpiramide', 'oxametacin', 'proglumetacin', 
'ketorolac', 'aceclofenac', 'bufexamac', 'piroxicam', 'tenoxicam', 'droxicam', 'lornoxicam', 'meloxicam', 'ibuprofen', 'naproxen', 'ketoprofen', 'fenoprofen', 'fenbufen', 'benoxaprofen', 'suprofen', 'pirprofen', 'flurbiprofen', 'indoprofen', 'tiaprofenic acid', 'oxaprozin', 'ibuproxam', 'dexibuprofen', 'flunoxaprofen', 'alminoprofen', 
'dexketoprofen', 'naproxcinod', 'mefenamic acid', 'tolfenamic acid', 'flufenamic acid', 'meclofenamic acid', 'celecoxib', 'rofecoxib', 'valdecoxib', 'parecoxib', 'etoricoxib', 'lumiracoxib', 'polmacoxib', 'nabumetone', 'niflumic acid', 'azapropazone', 'glucosamine', 'benzydamine', 'glucosaminoglycan polysulfate', 'proquazone', 'orgotein', 
'nimesulide', 'feprazone', 'diacerein', 'morniflumate', 'tenidap', 'oxaceprol', 'chondroitin sulfate') or
       lowcase(PRODNME) in:('phenylbutazone', 'mofebutazone', 'oxyphenbutazone', 'clofezone', 'kebuzone', 'indometacin', 'sulindac', 'tolmetin', 'zomepirac', 'diclofenac', 'alclofenac', 'bumadizone', 'etodolac', 'lonazolac', 'fentiazac', 'acemetacin', 'difenpiramide', 'oxametacin', 'proglumetacin', 
'ketorolac', 'aceclofenac', 'bufexamac', 'piroxicam', 'tenoxicam', 'droxicam', 'lornoxicam', 'meloxicam', 'ibuprofen', 'naproxen', 'ketoprofen', 'fenoprofen', 'fenbufen', 'benoxaprofen', 'suprofen', 'pirprofen', 'flurbiprofen', 'indoprofen', 'tiaprofenic acid', 'oxaprozin', 'ibuproxam', 'dexibuprofen', 'flunoxaprofen', 'alminoprofen', 
'dexketoprofen', 'naproxcinod', 'mefenamic acid', 'tolfenamic acid', 'flufenamic acid', 'meclofenamic acid', 'celecoxib', 'rofecoxib', 'valdecoxib', 'parecoxib', 'etoricoxib', 'lumiracoxib', 'polmacoxib', 'nabumetone', 'niflumic acid', 'azapropazone', 'glucosamine', 'benzydamine', 'glucosaminoglycan polysulfate', 'proquazone', 'orgotein', 
'nimesulide', 'feprazone', 'diacerein', 'morniflumate', 'tenidap', 'oxaceprol', 'chondroitin sulfate')  or
       lowcase(GENNME) in:('phenylbutazone', 'mofebutazone', 'oxyphenbutazone', 'clofezone', 'kebuzone', 'indometacin', 'sulindac', 'tolmetin', 'zomepirac', 'diclofenac', 'alclofenac', 'bumadizone', 'etodolac', 'lonazolac', 'fentiazac', 'acemetacin', 'difenpiramide', 'oxametacin', 'proglumetacin', 
'ketorolac', 'aceclofenac', 'bufexamac', 'piroxicam', 'tenoxicam', 'droxicam', 'lornoxicam', 'meloxicam', 'ibuprofen', 'naproxen', 'ketoprofen', 'fenoprofen', 'fenbufen', 'benoxaprofen', 'suprofen', 'pirprofen', 'flurbiprofen', 'indoprofen', 'tiaprofenic acid', 'oxaprozin', 'ibuproxam', 'dexibuprofen', 'flunoxaprofen', 'alminoprofen', 
'dexketoprofen', 'naproxcinod', 'mefenamic acid', 'tolfenamic acid', 'flufenamic acid', 'meclofenamic acid', 'celecoxib', 'rofecoxib', 'valdecoxib', 'parecoxib', 'etoricoxib', 'lumiracoxib', 'polmacoxib', 'nabumetone', 'niflumic acid', 'azapropazone', 'glucosamine', 'benzydamine', 'glucosaminoglycan polysulfate', 'proquazone', 'orgotein', 
'nimesulide', 'feprazone', 'diacerein', 'morniflumate', 'tenidap', 'oxaceprol', 'chondroitin sulfate');

run;


data mscan.ndc_nonstatin;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('clofibrate', 'bezafibrate', 'aluminium clofibrate', 'gemfibrozil', 'fenofibrate', 'simfibrate', 'ronifibrate', 'ciprofibrate', 'etofibrate', 'clofibride', 'choline fenofibrate', 'colestyramine', 'colestipol', 'colextran', 'colesevelam', 'niceritrol', 'nicotinic acid', 'nicofuranose', 'aluminium nicotinate',
'nicotinyl alcohol (pyridylcarbinol)', 'pyridylcarbinol', 'nicotinyl alcohol', 'acipimox', 'nicotinic acid, combinations', 'dextrothyroxine', 'probucol', 'tiadenol', 'meglutol', 'omega-3 triglycerides', 'magnesium pyridoxal 5-phosphate glutamate', 'policosanol', 'ezetimibe', 'alipogene tiparvovec', 'mipomersen', 'lomitapide', 'evolocumab', 'alirocumab', 'bempedoic acid')
       or
       lowcase(THRGRDS) in:('clofibrate', 'bezafibrate', 'aluminium clofibrate', 'gemfibrozil', 'fenofibrate', 'simfibrate', 'ronifibrate', 'ciprofibrate', 'etofibrate', 'clofibride', 'choline fenofibrate', 'colestyramine', 'colestipol', 'colextran', 'colesevelam', 'niceritrol', 'nicotinic acid', 'nicofuranose', 'aluminium nicotinate', 'nicotinyl alcohol (pyridylcarbinol)',
'pyridylcarbinol', 'nicotinyl alcohol', 'acipimox', 'nicotinic acid, combinations', 'dextrothyroxine', 'probucol', 'tiadenol', 'meglutol', 'omega-3 triglycerides', 'magnesium pyridoxal 5-phosphate glutamate', 'policosanol', 'ezetimibe', 'alipogene tiparvovec', 'mipomersen', 'lomitapide', 'evolocumab', 'alirocumab', 'bempedoic acid')
       or
       lowcase(PRODNME) in:('clofibrate', 'bezafibrate', 'aluminium clofibrate', 'gemfibrozil', 'fenofibrate', 'simfibrate', 'ronifibrate', 'ciprofibrate', 'etofibrate', 'clofibride', 'choline fenofibrate', 'colestyramine', 'colestipol', 'colextran', 'colesevelam', 'niceritrol', 'nicotinic acid', 'nicofuranose', 'aluminium nicotinate', 'nicotinyl alcohol (pyridylcarbinol)', 
'pyridylcarbinol', 'nicotinyl alcohol', 'acipimox', 'nicotinic acid, combinations', 'dextrothyroxine', 'probucol', 'tiadenol', 'meglutol', 'omega-3 triglycerides', 'magnesium pyridoxal 5-phosphate glutamate', 'policosanol', 'ezetimibe', 'alipogene tiparvovec', 'mipomersen', 'lomitapide', 'evolocumab', 'alirocumab', 'bempedoic acid')
       or
       lowcase(GENNME) in:('clofibrate', 'bezafibrate', 'aluminium clofibrate', 'gemfibrozil', 'fenofibrate', 'simfibrate', 'ronifibrate', 'ciprofibrate', 'etofibrate', 'clofibride', 'choline fenofibrate', 'colestyramine', 'colestipol', 'colextran', 'colesevelam', 'niceritrol', 'nicotinic acid', 'nicofuranose', 'aluminium nicotinate', 'nicotinyl alcohol (pyridylcarbinol)', 
'pyridylcarbinol', 'nicotinyl alcohol', 'acipimox', 'nicotinic acid, combinations', 'dextrothyroxine', 'probucol', 'tiadenol', 'meglutol', 'omega-3 triglycerides', 'magnesium pyridoxal 5-phosphate glutamate', 'policosanol', 'ezetimibe', 'alipogene tiparvovec', 'mipomersen', 'lomitapide', 'evolocumab', 'alirocumab', 'bempedoic acid');

run;

data mscan.ndc_proton_pump_inhibitors;
    set source.redbook_2010 source.redbook_2011 source.redbook_2012 source.redbook_2013 source.redbook_2014 source.redbook_2015 source.redbook_2017 source.redbook2018 source.redbook_2019 source.redbook_2020;

    if lowcase(THRCLDS) in:('omeprazole', 'pantoprazole', 'lansoprazole', 'rabeprazole', 'esomeprazole', 'dexlansoprazole', 'dexrabeprazole', 'vonoprazan')
       or
       lowcase(THRGRDS) in:('omeprazole', 'pantoprazole', 'lansoprazole', 'rabeprazole', 'esomeprazole', 'dexlansoprazole', 'dexrabeprazole', 'vonoprazan')
       or
       lowcase(PRODNME) in:('omeprazole', 'pantoprazole', 'lansoprazole', 'rabeprazole', 'esomeprazole', 'dexlansoprazole', 'dexrabeprazole', 'vonoprazan')
       or
       lowcase(GENNME) in:('omeprazole', 'pantoprazole', 'lansoprazole', 'rabeprazole', 'esomeprazole', 'dexlansoprazole', 'dexrabeprazole', 'vonoprazan');

run;
